# Chomik Backend

Chomik Backend - это бэкенд для системы онлайн-маркета, декомпозированный на микросервисы с использованием архитектурного паттерна Gateway.

## Архитектура

### Gateway
`chomik-gateway` является входной точкой в сервис. В этом микросервисе осуществляется аутентификация и авторизация пользователей, после чего запросы делегируются соответствующим сервисам.

### Микросервисы
- **chomik-orders**: инкапсулирует информацию о заказах.
- **chomik-storage**: содержит каталог товаров и предоставляет API для взаимодействия с ними.
- **chomik-delivery**: несет информацию, необходимую для осуществления доставки заказа.
- **chomik-payment**: обрабатывает оплату заказа.

### Mock-сервисы
- **delivery-mock**: имитирует работу сервиса доставки.
- **payment-mock**: имитирует работу банка.

## База данных
Проект использует базу данных **PostgreSQL**.

## Взаимодействие между сервисами
Взаимодействие между сервисами осуществляется посредством библиотек-клиентов, которые используют:
- Синхронное обращение через `RestTemplate`.
- Асинхронное взаимодействие с использованием `Kafka`.

## Обработка статуса платежей
Обработка статуса платежей реализована через callback.

## Мониторинг
Система мониторинга реализована с использованием `Grafana`.

## Распределенные транзакции
Используется механизм распределенных транзакций с `Atomikos`, применяемый в случаях, когда метод обращается к двум `datasources`.

## Планировщик задач
`Quartz` используется для планирования задач и запущен на нескольких инстансах одного сервиса, проверяющего статус оплаты заказа.

## Развертывание
Проект поднимается с использованием `docker-compose` файла.

## Сборка и развертывание
Проект использует:
- **Jenkins** для сборки.
- **OpenShift** для развертывания.
- **CI/CD** для автоматизации процессов сборки и развертывания.

## Установка и запуск

### Предварительные требования
- Docker и Docker Compose
- Java
- Kafka

### Инструкции по запуску
1. Клонируйте репозиторий:
    ```sh
    git clone <repository-url>
    cd chomik-backend
    ```

2. Запустите сервисы с помощью Docker Compose:
    ```sh
    docker-compose up
    ```

3. Сервис будет доступен по адресу `http://localhost:<port>`.
